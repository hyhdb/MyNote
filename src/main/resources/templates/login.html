<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>MyNote - 로그인</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="d-flex align-items-center py-4 bg-light" style="height: 100vh;">
<main class="form-signin w-100 m-auto" style="max-width: 330px;">
    <h1 class="h3 mb-3 fw-normal text-center">로그인</h1>

    <div class="form-floating mb-2">
        <input type="text" class="form-control" id="username" placeholder="아이디">
        <label for="username">아이디</label>
    </div>
    <div class="form-floating mb-3">
        <input type="password" class="form-control" id="password" placeholder="비밀번호">
        <label for="password">비밀번호</label>
    </div>

    <button class="w-100 btn btn-lg btn-primary mb-2" onclick="login()">로그인</button>
    <a href="/register" class="w-100 btn btn-lg btn-outline-success">회원가입</a> <p class="mt-3 text-center"><a href="/">홈으로 돌아가기</a></p>
</main>

<script>
    async function login() {
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;

        // 백엔드 /auth/login API 호출
        const response = await fetch('/auth/login', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ username, password })
        });

        const result = await response.json();

        if (result.success) {
            // 로그인 성공 시 토큰을 브라우저 로컬 스토리지에 저장합니다.
            localStorage.setItem('token', result.data);
            alert('로그인 성공!');
            location.href = '/memos-view'; // 메모 목록 페이지로 이동 (곧 만들 예정)
        } else {
            alert('로그인 실패: ' + result.error);
        }
    }
</script>
</body>
</html>